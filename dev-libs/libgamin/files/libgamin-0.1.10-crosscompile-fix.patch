diff --git a/configure.in b/configure.in
index eb129db..a88193b 100644
--- a/configure.in
+++ b/configure.in
@@ -389,8 +389,7 @@ fi
 
 AC_MSG_CHECKING(abstract socket namespace)
 AC_LANG_PUSH(C)
-AC_RUN_IFELSE([AC_LANG_PROGRAM(
-[[
+AC_TRY_RUN([
 #include <sys/types.h>
 #include <stdlib.h>
 #include <string.h>
@@ -398,8 +397,7 @@ AC_RUN_IFELSE([AC_LANG_PROGRAM(
 #include <sys/socket.h>
 #include <sys/un.h>
 #include <errno.h>
-]],
-[[
+int main() {
   int listen_fd;
   struct sockaddr_un addr;
   
@@ -424,9 +422,11 @@ AC_RUN_IFELSE([AC_LANG_PROGRAM(
     }
   else 
     exit (0);
-]])],
-              [have_abstract_sockets=yes],
-              [have_abstract_sockets=no])
+}
+],
+have_abstract_sockets=yes,
+have_abstract_sockets=no,
+have_abstract_sockets=no)
 AC_LANG_POP(C)
 AC_MSG_RESULT($have_abstract_sockets)
 
